from telegram import Update
from telegram.ext import CallbackContext
from handlers.command_handler import handle_voice_command

#–ö–æ–º–∞–Ω–¥–∞ /start
def start(update: Update, context: CallbackContext) -> None:
    user_first_name = update.effective_user.first_name if update.effective_user.first_name else "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    welcome_message = (
        f"–ü—Ä–∏–≤–µ—Ç, {user_first_name}! –Ø —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.\n\n"
        "–ß—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã, –≤–≤–µ–¥–∏ /help:\n"
    )
    update.message.reply_text(welcome_message)

# –ö–æ–º–∞–Ω–¥–∞ /help
def help_command(update: Update, context: CallbackContext) -> None:
    help_message = (
        "‚úâÔ∏è *–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ü–æ—á—Ç—ã:*\n\n"
        "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ\n"
        "`/sendmail email@example.com –¢–µ–º–∞ –ø–∏—Å—å–º–∞`\n\n"
        "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é\n"
        "`/sendmailat email@example.com –¢–µ–º–∞ –ø–∏—Å—å–º–∞ | –¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞ | [–í—Ä–µ–º—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, '–ó–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º' –∏–ª–∏ '20 –º–∞—Ä—Ç–∞ 2025 –≥–æ–¥, –≤ 14:30']`\n\n"
        "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É\n"
        "`/senddraft –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–µ—Ä–Ω–æ–≤–∏–∫–∞`\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n"
        "`/getunread`\n\n"
        "–ù–∞–π—Ç–∏ –ø–∏—Å—å–º–æ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É\n"
        "`/findemail –¢–µ–º–∞ –ø–∏—Å—å–º–∞`\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∏—Å—å–º–∞ –∏–∑ –≤—Ö–æ–¥—è—â–∏—Ö\n"
        "`/inbox`\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n"
        "`/getstarred`\n\n"
        "–£–¥–∞–ª–∏—Ç—å —Å–ø–∞–º\n"
        "`/deletespam`\n\n"
        "–£–¥–∞–ª–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É\n"
        "`/deletetrash`\n\n"
        "–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∞–∫—Ü–∏–∏\n"
        "`/deletepromo`\n\n"
        "üìù *–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ó–∞–º–µ—Ç–æ–∫ (Google Keep):*\n\n"
        "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É\n"
        "`/addnote –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–º–µ—Ç–∫–∏ | –¢–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏`\n\n"
        "üîî *–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ö–∞–ª–µ–Ω–¥–∞—Ä—è:*\n\n"
        "–î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ\n"
        "`/addevent –ù–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –Ω–∞—á–∞–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä 17:00), –∫–æ–Ω–µ—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä 19:00), 5 –º–∏–Ω—É—Ç`\n\n"
        "–û—Ç–º–µ–Ω–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é\n"
        "`/cancelevent –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è`\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å –ø–æ–≤–µ—Å—Ç–∫—É –¥–Ω—è\n"
        "`/schedule [–°–µ–≥–æ–¥–Ω—è –∏–ª–∏ –¥–∞—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, '20 –º–∞—Ä—Ç–∞ 2050 –≥–æ–¥']`\n\n"
        "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–ª—è —Å–æ–±—ã—Ç–∏—è\n"
        "`/setreminder –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è, 5 –º–∏–Ω—É—Ç`\n\n"
        "üíæ *–ö–æ–º–∞–Ω–¥—ã –¥–ª—è Google –î–∏—Å–∫–∞:*\n\n"
        "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ Google –î–∏—Å–∫\n"
        "`/upload –§–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç)`\n\n"
        "–ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É\n"
        "`/done`\n\n"
        "üå§Ô∏è *–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ü–æ–≥–æ–¥—ã:*\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ\n"
        "`/weather –ì–æ—Ä–æ–¥`\n\n"
        "–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π\n"
        "`/forecast –ì–æ—Ä–æ–¥ [–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–Ω–µ–π]`\n\n"
        "‚ÑπÔ∏è *–û–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:*\n\n"
        "–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º\n"
        "`/start`\n\n"
        "–°–ø—Ä–∞–≤–∫–∞\n"
        "`/help`"
    )
    update.message.reply_text(help_message, parse_mode="Markdown")

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
def handle_text_message(update: Update, context: CallbackContext) -> None:
    update.message.reply_text(
        "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. "
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã /start, /help –∏ —Ç.–¥."
    )


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π: –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö
def handle_message(update: Update, context: CallbackContext) -> None:
    if update.message.voice:
        # –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ command_parser
        handle_voice_command(update, context)
    else:
        handle_text_message(update, context)